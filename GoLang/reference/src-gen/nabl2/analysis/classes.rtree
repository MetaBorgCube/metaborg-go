Module("analysis/classes",[Imports([ImportWildcard("signatures/nabl2/shared"),ImportWildcard("signatures/nabl2/shared/common"),ImportWildcard("signatures/nabl2/shared/constraints"),ImportWildcard("nabl2/shared"),ImportWildcard("signatures/nabl2/runtime"),ImportWildcard("signatures/nabl2/runtime/analysis"),ImportWildcard("signatures/nabl2/runtime/common"),ImportWildcard("signatures/nabl2/runtime/solver"),ImportWildcard("nabl2/runtime"),ImportWildcard("nabl2/runtime/analysis"),ImportWildcard("nabl2/runtime/common"),ImportWildcard("nabl2/runtime/editor"),ImportWildcard("nabl2/runtime/prelude"),ImportWildcard("nabl2/runtime/solver"),ImportWildcard("nabl2/runtime/stdlib")]),Rules([]),Imports([ImportWildcard("signatures"),ImportWildcard("reference/src-gen/nabl2/analysis")]),Rules([RDefT("nabl2--generate-constraint-default-rule",[],[DefaultVarDec("nabl2_source"),DefaultVarDec("nabl2_args")],Rule(As(Var("nabl2_term"),NoAnnoList(Op("Class",[Var("x"),Var("parent"),Var("ff"),Var("mm")]))),Var("nabl2_constraint"),[WithClause(LChoice(Assign(NoAnnoList(Op("Params",[As(Var("nabl2_params"),NoAnnoList(Tuple([Var("s")])))])),Var("nabl2_args")),CallT(SVar("fatal-err"),[],[App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Cannot match expected \"")),NoAnnoList(Str("\"^ (s)\"")),NoAnnoList(Str("\" with actual \"")),App(CallNoArgs(SVar("nabl2--pp-flat-args")),Var("nabl2_args")),NoAnnoList(Str("\" when matching \"")),NoAnnoList(Str("\"Class(x, parent, ff, mm)\"")),NoAnnoList(Str("\" with \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\".\""))])))]))),WithClause(IfThen(CallNoArgs(SVar("nabl2-debug-constraint-generation-hook")),BA(Seq(CallNoArgs(SVar("concat-strings")),CallNoArgs(SVar("debug"))),NoAnnoList(List([NoAnnoList(Str("\"default\"")),NoAnnoList(Str("\" [[ \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\" ^ \"")),App(CallNoArgs(SVar("pp-NaBL2-CTerm")),Var("nabl2_params")),NoAnnoList(Str("\" ]]\""))]))))),WithClause(Seq(Assign(Var("ty"),App(CallT(SVar("nabl2--new-var"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"ty\"")))),Id)),WithClause(Seq(Assign(Var("cs"),App(CallT(SVar("nabl2--new-scope"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"cs\"")))),Id)),WithClause(Seq(Assign(Var("nabl2_index"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))),GenDynRules([SetDynRule(DynRuleId(RDecNoArgs("AstMetadata")),RuleNoCond(Var("nabl2_index"),NoAnnoList(List([NoAnnoList(Tuple([NoAnnoList(Op("Params",[])),Var("nabl2_params")]))]))))]))),WithClause(Assign(Var("nabl2_constraint"),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGDecl",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Class\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),Var("s")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGAssoc",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Class\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),NoAnnoList(Op("I",[])),Var("cs")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Class\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),NoAnnoList(Op("Type",[])),NoAnnoList(Op("ClassType",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Class\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))]))])),NoAnnoList(Str("\"!\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGDecl",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Implicit\""))])),NoAnnoList(Op("This",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))])),Var("cs")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Implicit\""))])),NoAnnoList(Op("This",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))])),NoAnnoList(Op("Type",[])),NoAnnoList(Op("ClassType",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Class\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))]))])),NoAnnoList(Str("\"!\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CDistinct",[NoAnnoList(Op("Declarations",[Var("cs"),NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))]))])),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Text",[NoAnnoList(Str("\"Duplicate field\""))])),NoAnnoList(Op("NAME",[]))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CDistinct",[NoAnnoList(Op("Declarations",[Var("cs"),NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Method\""))]))])),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Text",[NoAnnoList(Str("\"Duplicate method\""))])),NoAnnoList(Op("NAME",[]))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CSubsetEq",[NoAnnoList(Op("Isect",[NoAnnoList(Op("Declarations",[Var("cs"),NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))]))])),NoAnnoList(Op("Diff",[NoAnnoList(Op("Reachables",[Var("cs"),NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))]))])),NoAnnoList(Op("Declarations",[Var("cs"),NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))]))]))]))])),NoAnnoList(Op("EmptySet",[])),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Text",[NoAnnoList(Str("\"Field hides inherited field\""))])),NoAnnoList(Op("NAME",[]))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGDirectEdge",[Var("cs"),NoAnnoList(Op("P",[])),Var("s")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("FSubtype",[NoAnnoList(Op("ClassType",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Class\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))]))])),Var("ty"),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[App(CallT(SVar("nabl2--generate-constraint"),[CallNoArgs(SVar("nabl2--generate-constraint-default-rule"))],[Var("nabl2_source"),NoAnnoList(Op("ParamsAndType",[NoAnnoList(Tuple([Var("s"),Var("cs")])),Var("ty")]))]),Var("parent")),NoAnnoList(Op("CConj",[App(CallT(SVar("nabl2--generate-constraint"),[CallNoArgs(SVar("nabl2--generate-constraint-Map2-rule"))],[Var("nabl2_source"),NoAnnoList(Op("Params",[NoAnnoList(Tuple([Var("cs"),Var("x")]))]))]),Var("ff")),App(CallT(SVar("nabl2--generate-constraint"),[CallNoArgs(SVar("nabl2--generate-constraint-Map2-rule"))],[Var("nabl2_source"),NoAnnoList(Op("Params",[NoAnnoList(Tuple([Var("cs"),Var("x")]))]))]),Var("mm"))]))]))]))]))]))]))]))]))]))]))]))]))))])),RDefT("nabl2--generate-constraint-default-rule",[],[DefaultVarDec("nabl2_source"),DefaultVarDec("nabl2_args")],Rule(As(Var("nabl2_term"),NoAnnoList(Op("Parent",[Var("x")]))),Var("nabl2_constraint"),[WithClause(LChoice(Assign(NoAnnoList(Op("ParamsAndType",[As(Var("nabl2_params"),NoAnnoList(Tuple([Var("s"),Var("cs")]))),As(Var("nabl2_type"),Var("ty"))])),Var("nabl2_args")),CallT(SVar("fatal-err"),[],[App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Cannot match expected \"")),NoAnnoList(Str("\"^ (s, cs) : ty\"")),NoAnnoList(Str("\" with actual \"")),App(CallNoArgs(SVar("nabl2--pp-flat-args")),Var("nabl2_args")),NoAnnoList(Str("\" when matching \"")),NoAnnoList(Str("\"Parent(x)\"")),NoAnnoList(Str("\" with \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\".\""))])))]))),WithClause(IfThen(CallNoArgs(SVar("nabl2-debug-constraint-generation-hook")),BA(Seq(CallNoArgs(SVar("concat-strings")),CallNoArgs(SVar("debug"))),NoAnnoList(List([NoAnnoList(Str("\"default\"")),NoAnnoList(Str("\" [[ \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\" ^ \"")),App(CallNoArgs(SVar("pp-NaBL2-CTerm")),Var("nabl2_params")),NoAnnoList(Str("\" : \"")),App(CallNoArgs(SVar("pp-NaBL2-Type")),Var("nabl2_type")),NoAnnoList(Str("\" ]]\""))]))))),WithClause(Seq(Assign(Var("ty1"),App(CallT(SVar("nabl2--new-var"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"ty1\"")))),Seq(Assign(Var("d_parent"),App(CallT(SVar("nabl2--new-var"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"d_parent\"")))),Id))),WithClause(Seq(Assign(Var("nabl2_index"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))),GenDynRules([SetDynRule(DynRuleId(RDecNoArgs("AstMetadata")),RuleNoCond(Var("nabl2_index"),NoAnnoList(List([NoAnnoList(Tuple([NoAnnoList(Op("Params",[])),Var("nabl2_params")])),NoAnnoList(Tuple([NoAnnoList(Op("Type",[])),Var("nabl2_type")]))]))))]))),WithClause(Assign(Var("nabl2_constraint"),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGRef",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Class\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),Var("s")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGNamedEdge",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Class\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),NoAnnoList(Op("I",[])),Var("cs")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CResolve",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Class\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),Var("d_parent"),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[Var("d_parent"),NoAnnoList(Op("Type",[])),Var("ty1"),NoAnnoList(Str("\"\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CInequal",[Var("ty1"),NoAnnoList(Op("MainType",[])),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Text",[NoAnnoList(Str("\"Cannot inherit from main class\""))])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))]))])),NoAnnoList(Op("CEqual",[Var("ty"),NoAnnoList(Op("ClassType",[Var("d_parent")])),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))]))]))]))]))]))]))))])),RDefT("nabl2--generate-constraint-default-rule",[],[DefaultVarDec("nabl2_source"),DefaultVarDec("nabl2_args")],Rule(As(Var("nabl2_term"),NoAnnoList(Op("None",[]))),Var("nabl2_constraint"),[WithClause(LChoice(Assign(NoAnnoList(Op("ParamsAndType",[As(Var("nabl2_params"),NoAnnoList(Tuple([Var("s"),Var("cs")]))),As(Var("nabl2_type"),Var("ty"))])),Var("nabl2_args")),CallT(SVar("fatal-err"),[],[App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Cannot match expected \"")),NoAnnoList(Str("\"^ (s, cs) : ty\"")),NoAnnoList(Str("\" with actual \"")),App(CallNoArgs(SVar("nabl2--pp-flat-args")),Var("nabl2_args")),NoAnnoList(Str("\" when matching \"")),NoAnnoList(Str("\"None()\"")),NoAnnoList(Str("\" with \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\".\""))])))]))),WithClause(IfThen(CallNoArgs(SVar("nabl2-debug-constraint-generation-hook")),BA(Seq(CallNoArgs(SVar("concat-strings")),CallNoArgs(SVar("debug"))),NoAnnoList(List([NoAnnoList(Str("\"default\"")),NoAnnoList(Str("\" [[ \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\" ^ \"")),App(CallNoArgs(SVar("pp-NaBL2-CTerm")),Var("nabl2_params")),NoAnnoList(Str("\" : \"")),App(CallNoArgs(SVar("pp-NaBL2-Type")),Var("nabl2_type")),NoAnnoList(Str("\" ]]\""))]))))),WithClause(Id),WithClause(Seq(Assign(Var("nabl2_index"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))),GenDynRules([SetDynRule(DynRuleId(RDecNoArgs("AstMetadata")),RuleNoCond(Var("nabl2_index"),NoAnnoList(List([NoAnnoList(Tuple([NoAnnoList(Op("Params",[])),Var("nabl2_params")])),NoAnnoList(Tuple([NoAnnoList(Op("Type",[])),Var("nabl2_type")]))]))))]))),WithClause(Assign(Var("nabl2_constraint"),NoAnnoList(Op("CEqual",[Var("ty"),NoAnnoList(Op("ClassType",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Class\""))])),NoAnnoList(Str("\"Object\"")),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))]))))])),RDefT("nabl2--generate-constraint-default-rule",[],[DefaultVarDec("nabl2_source"),DefaultVarDec("nabl2_args")],Rule(As(Var("nabl2_term"),NoAnnoList(Op("Field",[Var("c"),Var("x")]))),Var("nabl2_constraint"),[WithClause(LChoice(Assign(NoAnnoList(Op("Params",[As(Var("nabl2_params"),NoAnnoList(Tuple([Var("s"),Var("cname")])))])),Var("nabl2_args")),CallT(SVar("fatal-err"),[],[App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Cannot match expected \"")),NoAnnoList(Str("\"^ (s, cname)\"")),NoAnnoList(Str("\" with actual \"")),App(CallNoArgs(SVar("nabl2--pp-flat-args")),Var("nabl2_args")),NoAnnoList(Str("\" when matching \"")),NoAnnoList(Str("\"Field(c, x)\"")),NoAnnoList(Str("\" with \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\".\""))])))]))),WithClause(IfThen(CallNoArgs(SVar("nabl2-debug-constraint-generation-hook")),BA(Seq(CallNoArgs(SVar("concat-strings")),CallNoArgs(SVar("debug"))),NoAnnoList(List([NoAnnoList(Str("\"default\"")),NoAnnoList(Str("\" [[ \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\" ^ \"")),App(CallNoArgs(SVar("pp-NaBL2-CTerm")),Var("nabl2_params")),NoAnnoList(Str("\" ]]\""))]))))),WithClause(Seq(Assign(Var("ty"),App(CallT(SVar("nabl2--new-var"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"ty\"")))),Id)),WithClause(Seq(Assign(Var("nabl2_index"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))),GenDynRules([SetDynRule(DynRuleId(RDecNoArgs("AstMetadata")),RuleNoCond(Var("nabl2_index"),NoAnnoList(List([NoAnnoList(Tuple([NoAnnoList(Op("Params",[])),Var("nabl2_params")]))]))))]))),WithClause(Assign(Var("nabl2_constraint"),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGDecl",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),Var("s")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),NoAnnoList(Op("Type",[])),Var("ty"),NoAnnoList(Str("\"!\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),NoAnnoList(Op("Property",[NoAnnoList(Str("\"origin\""))])),NoAnnoList(Op("Field",[])),NoAnnoList(Str("\"\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),NoAnnoList(Op("Property",[NoAnnoList(Str("\"cname\""))])),Var("cname"),NoAnnoList(Str("\"\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),App(CallT(SVar("nabl2--generate-constraint"),[CallNoArgs(SVar("nabl2--generate-constraint-default-rule"))],[Var("nabl2_source"),NoAnnoList(Op("ParamsAndType",[NoAnnoList(Tuple([Var("s")])),Var("ty")]))]),Var("c"))]))]))]))]))))])),RDefT("nabl2--generate-constraint-default-rule",[],[DefaultVarDec("nabl2_source"),DefaultVarDec("nabl2_args")],Rule(As(Var("nabl2_term"),NoAnnoList(Op("Method",[Var("c"),Var("x"),Var("aa"),Var("vv"),Var("ss"),Var("e")]))),Var("nabl2_constraint"),[WithClause(LChoice(Assign(NoAnnoList(Op("Params",[As(Var("nabl2_params"),NoAnnoList(Tuple([Var("s"),Var("cname")])))])),Var("nabl2_args")),CallT(SVar("fatal-err"),[],[App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Cannot match expected \"")),NoAnnoList(Str("\"^ (s, cname)\"")),NoAnnoList(Str("\" with actual \"")),App(CallNoArgs(SVar("nabl2--pp-flat-args")),Var("nabl2_args")),NoAnnoList(Str("\" when matching \"")),NoAnnoList(Str("\"Method(c, x, aa, vv, ss, e)\"")),NoAnnoList(Str("\" with \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\".\""))])))]))),WithClause(IfThen(CallNoArgs(SVar("nabl2-debug-constraint-generation-hook")),BA(Seq(CallNoArgs(SVar("concat-strings")),CallNoArgs(SVar("debug"))),NoAnnoList(List([NoAnnoList(Str("\"default\"")),NoAnnoList(Str("\" [[ \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\" ^ \"")),App(CallNoArgs(SVar("pp-NaBL2-CTerm")),Var("nabl2_params")),NoAnnoList(Str("\" ]]\""))]))))),WithClause(Seq(Assign(Var("d_m"),App(CallT(SVar("nabl2--new-var"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"d_m\"")))),Seq(Assign(Var("cty'"),App(CallT(SVar("nabl2--new-var"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"cty'\"")))),Seq(Assign(Var("aaty'"),App(CallT(SVar("nabl2--new-var"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"aaty'\"")))),Seq(Assign(Var("aaty"),App(CallT(SVar("nabl2--new-var"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"aaty\"")))),Seq(Assign(Var("ety"),App(CallT(SVar("nabl2--new-var"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"ety\"")))),Seq(Assign(Var("cty"),App(CallT(SVar("nabl2--new-var"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"cty\"")))),Id))))))),WithClause(Seq(Assign(Var("s'"),App(CallT(SVar("nabl2--new-scope"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"s'\"")))),Id)),WithClause(Seq(Assign(Var("as"),App(CallT(SVar("nabl2--new-scope"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"as\"")))),Id)),WithClause(Seq(Assign(Var("ms"),App(CallT(SVar("nabl2--new-scope"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"ms\"")))),Id)),WithClause(Seq(Assign(Var("nabl2_index"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))),GenDynRules([SetDynRule(DynRuleId(RDecNoArgs("AstMetadata")),RuleNoCond(Var("nabl2_index"),NoAnnoList(List([NoAnnoList(Tuple([NoAnnoList(Op("Params",[])),Var("nabl2_params")]))]))))]))),WithClause(Assign(Var("nabl2_constraint"),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGDecl",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Method\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),Var("s")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Method\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),NoAnnoList(Op("Type",[])),NoAnnoList(Op("MethodType",[Var("cty"),Var("aaty")])),NoAnnoList(Str("\"!\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Method\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),NoAnnoList(Op("Property",[NoAnnoList(Str("\"cname\""))])),Var("cname"),NoAnnoList(Str("\"\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGRef",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Method\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),Var("s'")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGDirectEdge",[Var("s'"),NoAnnoList(Op("I",[])),Var("s")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGDirectEdge",[Var("s'"),NoAnnoList(Op("Label",[NoAnnoList(Str("\"S\""))])),Var("s")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CResolve",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Method\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),Var("d_m"),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[Var("d_m"),NoAnnoList(Op("Type",[])),NoAnnoList(Op("MethodType",[Var("cty'"),Var("aaty'")])),NoAnnoList(Str("\"\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CSubtype",[Var("cty"),Var("cty'"),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Text",[NoAnnoList(Str("\"Erroneous overriding\""))])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CEqual",[Var("aaty'"),Var("aaty"),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Text",[NoAnnoList(Str("\"Overloading\""))])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))]))])),NoAnnoList(Op("CConj",[App(CallT(SVar("nabl2--generate-constraint"),[CallNoArgs(SVar("nabl2--generate-constraint-default-rule"))],[Var("nabl2_source"),NoAnnoList(Op("ParamsAndType",[NoAnnoList(Tuple([Var("s")])),Var("cty")]))]),Var("c")),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGDirectEdge",[Var("ms"),NoAnnoList(Op("P",[])),Var("s")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CDistinct",[NoAnnoList(Op("Declarations",[Var("ms"),NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))]))])),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Text",[NoAnnoList(Str("\"Multiple definitions for variable\""))])),NoAnnoList(Op("NAME",[]))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CConj",[NoAnnoList(Op("CSubsetEq",[NoAnnoList(Op("Isect",[NoAnnoList(Op("Declarations",[Var("ms"),NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))]))])),NoAnnoList(Op("Reachables",[Var("s"),NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))]))]))])),NoAnnoList(Op("EmptySet",[])),NoAnnoList(Op("Message",[NoAnnoList(Op("Warning",[])),NoAnnoList(Op("Text",[NoAnnoList(Str("\"Variable hides local field\""))])),NoAnnoList(Op("NAME",[]))]))])),NoAnnoList(Op("CSubsetEq",[NoAnnoList(Op("EmptySet",[])),NoAnnoList(Op("Isect",[NoAnnoList(Op("Declarations",[Var("ms"),NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))]))])),NoAnnoList(Op("Reachables",[Var("s"),NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))]))]))])),NoAnnoList(Op("Message",[NoAnnoList(Op("Warning",[])),NoAnnoList(Op("Text",[NoAnnoList(Str("\"Variable hides local field\""))])),NoAnnoList(Op("NAME",[]))]))]))])),NoAnnoList(Op("CConj",[App(CallT(SVar("nabl2--generate-constraint"),[CallNoArgs(SVar("nabl2--generate-constraint-Map1T-rule"))],[Var("nabl2_source"),NoAnnoList(Op("ParamsAndType",[NoAnnoList(Tuple([Var("ms")])),Var("aaty")]))]),Var("aa")),NoAnnoList(Op("CConj",[App(CallT(SVar("nabl2--generate-constraint"),[CallNoArgs(SVar("nabl2--generate-constraint-Map1-rule"))],[Var("nabl2_source"),NoAnnoList(Op("Params",[NoAnnoList(Tuple([Var("ms")]))]))]),Var("vv")),NoAnnoList(Op("CConj",[App(CallT(SVar("nabl2--generate-constraint"),[CallNoArgs(SVar("nabl2--generate-constraint-Map1-rule"))],[Var("nabl2_source"),NoAnnoList(Op("Params",[NoAnnoList(Tuple([Var("ms")]))]))]),Var("ss")),NoAnnoList(Op("CConj",[App(CallT(SVar("nabl2--generate-constraint"),[CallNoArgs(SVar("nabl2--generate-constraint-default-rule"))],[Var("nabl2_source"),NoAnnoList(Op("ParamsAndType",[NoAnnoList(Tuple([Var("ms")])),Var("ety")]))]),Var("e")),NoAnnoList(Op("CSubtype",[Var("ety"),Var("cty"),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Text",[NoAnnoList(Str("\"Type mismatch in return expression\""))])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("e"))]))]))]))]))]))]))]))]))]))]))]))]))]))]))]))]))]))]))]))]))))])),RDefT("nabl2--generate-constraint-default-rule",[],[DefaultVarDec("nabl2_source"),DefaultVarDec("nabl2_args")],Rule(As(Var("nabl2_term"),NoAnnoList(Op("Bind",[Var("i"),As(Var("ast"),NoAnnoList(Op("Param",[Var("c"),Var("x")])))]))),Var("nabl2_constraint"),[WithClause(LChoice(Assign(NoAnnoList(Op("ParamsAndType",[As(Var("nabl2_params"),NoAnnoList(Tuple([Var("s")]))),As(Var("nabl2_type"),Var("ty"))])),Var("nabl2_args")),CallT(SVar("fatal-err"),[],[App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Cannot match expected \"")),NoAnnoList(Str("\"^ (s) : ty\"")),NoAnnoList(Str("\" with actual \"")),App(CallNoArgs(SVar("nabl2--pp-flat-args")),Var("nabl2_args")),NoAnnoList(Str("\" when matching \"")),NoAnnoList(Str("\"Bind(i, Param(c, x))\"")),NoAnnoList(Str("\" with \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\".\""))])))]))),WithClause(IfThen(CallNoArgs(SVar("nabl2-debug-constraint-generation-hook")),BA(Seq(CallNoArgs(SVar("concat-strings")),CallNoArgs(SVar("debug"))),NoAnnoList(List([NoAnnoList(Str("\"default\"")),NoAnnoList(Str("\" [[ \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\" ^ \"")),App(CallNoArgs(SVar("pp-NaBL2-CTerm")),Var("nabl2_params")),NoAnnoList(Str("\" : \"")),App(CallNoArgs(SVar("pp-NaBL2-Type")),Var("nabl2_type")),NoAnnoList(Str("\" ]]\""))]))))),WithClause(Id),WithClause(Seq(Assign(Var("nabl2_index"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))),GenDynRules([SetDynRule(DynRuleId(RDecNoArgs("AstMetadata")),RuleNoCond(Var("nabl2_index"),NoAnnoList(List([NoAnnoList(Tuple([NoAnnoList(Op("Params",[])),Var("nabl2_params")])),NoAnnoList(Tuple([NoAnnoList(Op("Type",[])),Var("nabl2_type")]))]))))]))),WithClause(Assign(Var("nabl2_constraint"),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGDecl",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),Var("s")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),NoAnnoList(Op("Property",[NoAnnoList(Str("\"origin\""))])),NoAnnoList(Op("Local",[])),NoAnnoList(Str("\"\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),NoAnnoList(Op("Property",[NoAnnoList(Str("\"index\""))])),Var("i"),NoAnnoList(Str("\"\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),NoAnnoList(Op("Type",[])),Var("ty"),NoAnnoList(Str("\"!\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),App(CallT(SVar("nabl2--generate-constraint"),[CallNoArgs(SVar("nabl2--generate-constraint-default-rule"))],[Var("nabl2_source"),NoAnnoList(Op("ParamsAndType",[NoAnnoList(Tuple([Var("s")])),Var("ty")]))]),Var("c"))]))]))]))]))))])),RDefT("nabl2--generate-constraint-default-rule",[],[DefaultVarDec("nabl2_source"),DefaultVarDec("nabl2_args")],Rule(As(Var("nabl2_term"),NoAnnoList(Op("Bind",[Var("i"),As(Var("ast"),NoAnnoList(Op("Var",[Var("c"),Var("x")])))]))),Var("nabl2_constraint"),[WithClause(LChoice(Assign(NoAnnoList(Op("Params",[As(Var("nabl2_params"),NoAnnoList(Tuple([Var("s")])))])),Var("nabl2_args")),CallT(SVar("fatal-err"),[],[App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Cannot match expected \"")),NoAnnoList(Str("\"^ (s)\"")),NoAnnoList(Str("\" with actual \"")),App(CallNoArgs(SVar("nabl2--pp-flat-args")),Var("nabl2_args")),NoAnnoList(Str("\" when matching \"")),NoAnnoList(Str("\"Bind(i, Var(c, x))\"")),NoAnnoList(Str("\" with \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\".\""))])))]))),WithClause(IfThen(CallNoArgs(SVar("nabl2-debug-constraint-generation-hook")),BA(Seq(CallNoArgs(SVar("concat-strings")),CallNoArgs(SVar("debug"))),NoAnnoList(List([NoAnnoList(Str("\"default\"")),NoAnnoList(Str("\" [[ \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\" ^ \"")),App(CallNoArgs(SVar("pp-NaBL2-CTerm")),Var("nabl2_params")),NoAnnoList(Str("\" ]]\""))]))))),WithClause(Seq(Assign(Var("ty"),App(CallT(SVar("nabl2--new-var"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"ty\"")))),Id)),WithClause(Seq(Assign(Var("nabl2_index"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))),GenDynRules([SetDynRule(DynRuleId(RDecNoArgs("AstMetadata")),RuleNoCond(Var("nabl2_index"),NoAnnoList(List([NoAnnoList(Tuple([NoAnnoList(Op("Params",[])),Var("nabl2_params")]))]))))]))),WithClause(Assign(Var("nabl2_constraint"),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGDecl",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),Var("s")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),NoAnnoList(Op("Property",[NoAnnoList(Str("\"origin\""))])),NoAnnoList(Op("Local",[])),NoAnnoList(Str("\"\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),NoAnnoList(Op("Property",[NoAnnoList(Str("\"index\""))])),Var("i"),NoAnnoList(Str("\"\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Var\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),NoAnnoList(Op("Type",[])),Var("ty"),NoAnnoList(Str("\"!\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),App(CallT(SVar("nabl2--generate-constraint"),[CallNoArgs(SVar("nabl2--generate-constraint-default-rule"))],[Var("nabl2_source"),NoAnnoList(Op("ParamsAndType",[NoAnnoList(Tuple([Var("s")])),Var("ty")]))]),Var("c"))]))]))]))]))))])),RDefT("nabl2--generate-constraint-default-rule",[],[DefaultVarDec("nabl2_source"),DefaultVarDec("nabl2_args")],Rule(As(Var("nabl2_term"),NoAnnoList(Op("Int",[]))),Var("nabl2_constraint"),[WithClause(LChoice(Assign(NoAnnoList(Op("ParamsAndType",[As(Var("nabl2_params"),NoAnnoList(Tuple([Var("s")]))),As(Var("nabl2_type"),Var("ty"))])),Var("nabl2_args")),CallT(SVar("fatal-err"),[],[App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Cannot match expected \"")),NoAnnoList(Str("\"^ (s) : ty\"")),NoAnnoList(Str("\" with actual \"")),App(CallNoArgs(SVar("nabl2--pp-flat-args")),Var("nabl2_args")),NoAnnoList(Str("\" when matching \"")),NoAnnoList(Str("\"Int()\"")),NoAnnoList(Str("\" with \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\".\""))])))]))),WithClause(IfThen(CallNoArgs(SVar("nabl2-debug-constraint-generation-hook")),BA(Seq(CallNoArgs(SVar("concat-strings")),CallNoArgs(SVar("debug"))),NoAnnoList(List([NoAnnoList(Str("\"default\"")),NoAnnoList(Str("\" [[ \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\" ^ \"")),App(CallNoArgs(SVar("pp-NaBL2-CTerm")),Var("nabl2_params")),NoAnnoList(Str("\" : \"")),App(CallNoArgs(SVar("pp-NaBL2-Type")),Var("nabl2_type")),NoAnnoList(Str("\" ]]\""))]))))),WithClause(Id),WithClause(Seq(Assign(Var("nabl2_index"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))),GenDynRules([SetDynRule(DynRuleId(RDecNoArgs("AstMetadata")),RuleNoCond(Var("nabl2_index"),NoAnnoList(List([NoAnnoList(Tuple([NoAnnoList(Op("Params",[])),Var("nabl2_params")])),NoAnnoList(Tuple([NoAnnoList(Op("Type",[])),Var("nabl2_type")]))]))))]))),WithClause(Assign(Var("nabl2_constraint"),NoAnnoList(Op("CEqual",[Var("ty"),NoAnnoList(Op("Int",[])),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))]))))])),RDefT("nabl2--generate-constraint-default-rule",[],[DefaultVarDec("nabl2_source"),DefaultVarDec("nabl2_args")],Rule(As(Var("nabl2_term"),NoAnnoList(Op("Bool",[]))),Var("nabl2_constraint"),[WithClause(LChoice(Assign(NoAnnoList(Op("ParamsAndType",[As(Var("nabl2_params"),NoAnnoList(Tuple([Var("s")]))),As(Var("nabl2_type"),Var("ty"))])),Var("nabl2_args")),CallT(SVar("fatal-err"),[],[App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Cannot match expected \"")),NoAnnoList(Str("\"^ (s) : ty\"")),NoAnnoList(Str("\" with actual \"")),App(CallNoArgs(SVar("nabl2--pp-flat-args")),Var("nabl2_args")),NoAnnoList(Str("\" when matching \"")),NoAnnoList(Str("\"Bool()\"")),NoAnnoList(Str("\" with \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\".\""))])))]))),WithClause(IfThen(CallNoArgs(SVar("nabl2-debug-constraint-generation-hook")),BA(Seq(CallNoArgs(SVar("concat-strings")),CallNoArgs(SVar("debug"))),NoAnnoList(List([NoAnnoList(Str("\"default\"")),NoAnnoList(Str("\" [[ \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\" ^ \"")),App(CallNoArgs(SVar("pp-NaBL2-CTerm")),Var("nabl2_params")),NoAnnoList(Str("\" : \"")),App(CallNoArgs(SVar("pp-NaBL2-Type")),Var("nabl2_type")),NoAnnoList(Str("\" ]]\""))]))))),WithClause(Id),WithClause(Seq(Assign(Var("nabl2_index"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))),GenDynRules([SetDynRule(DynRuleId(RDecNoArgs("AstMetadata")),RuleNoCond(Var("nabl2_index"),NoAnnoList(List([NoAnnoList(Tuple([NoAnnoList(Op("Params",[])),Var("nabl2_params")])),NoAnnoList(Tuple([NoAnnoList(Op("Type",[])),Var("nabl2_type")]))]))))]))),WithClause(Assign(Var("nabl2_constraint"),NoAnnoList(Op("CEqual",[Var("ty"),NoAnnoList(Op("Bool",[])),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))]))))])),RDefT("nabl2--generate-constraint-default-rule",[],[DefaultVarDec("nabl2_source"),DefaultVarDec("nabl2_args")],Rule(As(Var("nabl2_term"),NoAnnoList(Op("IntArray",[]))),Var("nabl2_constraint"),[WithClause(LChoice(Assign(NoAnnoList(Op("ParamsAndType",[As(Var("nabl2_params"),NoAnnoList(Tuple([Var("s")]))),As(Var("nabl2_type"),Var("ty"))])),Var("nabl2_args")),CallT(SVar("fatal-err"),[],[App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Cannot match expected \"")),NoAnnoList(Str("\"^ (s) : ty\"")),NoAnnoList(Str("\" with actual \"")),App(CallNoArgs(SVar("nabl2--pp-flat-args")),Var("nabl2_args")),NoAnnoList(Str("\" when matching \"")),NoAnnoList(Str("\"IntArray()\"")),NoAnnoList(Str("\" with \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\".\""))])))]))),WithClause(IfThen(CallNoArgs(SVar("nabl2-debug-constraint-generation-hook")),BA(Seq(CallNoArgs(SVar("concat-strings")),CallNoArgs(SVar("debug"))),NoAnnoList(List([NoAnnoList(Str("\"default\"")),NoAnnoList(Str("\" [[ \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\" ^ \"")),App(CallNoArgs(SVar("pp-NaBL2-CTerm")),Var("nabl2_params")),NoAnnoList(Str("\" : \"")),App(CallNoArgs(SVar("pp-NaBL2-Type")),Var("nabl2_type")),NoAnnoList(Str("\" ]]\""))]))))),WithClause(Id),WithClause(Seq(Assign(Var("nabl2_index"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))),GenDynRules([SetDynRule(DynRuleId(RDecNoArgs("AstMetadata")),RuleNoCond(Var("nabl2_index"),NoAnnoList(List([NoAnnoList(Tuple([NoAnnoList(Op("Params",[])),Var("nabl2_params")])),NoAnnoList(Tuple([NoAnnoList(Op("Type",[])),Var("nabl2_type")]))]))))]))),WithClause(Assign(Var("nabl2_constraint"),NoAnnoList(Op("CEqual",[Var("ty"),NoAnnoList(Op("IntArray",[])),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))]))))])),RDefT("nabl2--generate-constraint-default-rule",[],[DefaultVarDec("nabl2_source"),DefaultVarDec("nabl2_args")],Rule(As(Var("nabl2_term"),NoAnnoList(Op("ClassType",[Var("x")]))),Var("nabl2_constraint"),[WithClause(LChoice(Assign(NoAnnoList(Op("ParamsAndType",[As(Var("nabl2_params"),NoAnnoList(Tuple([Var("s")]))),As(Var("nabl2_type"),Var("nabl2_type"))])),Var("nabl2_args")),CallT(SVar("fatal-err"),[],[App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Cannot match expected \"")),NoAnnoList(Str("\"^ (s) : nabl2_type\"")),NoAnnoList(Str("\" with actual \"")),App(CallNoArgs(SVar("nabl2--pp-flat-args")),Var("nabl2_args")),NoAnnoList(Str("\" when matching \"")),NoAnnoList(Str("\"ClassType(x)\"")),NoAnnoList(Str("\" with \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\".\""))])))]))),WithClause(IfThen(CallNoArgs(SVar("nabl2-debug-constraint-generation-hook")),BA(Seq(CallNoArgs(SVar("concat-strings")),CallNoArgs(SVar("debug"))),NoAnnoList(List([NoAnnoList(Str("\"default\"")),NoAnnoList(Str("\" [[ \"")),App(CallNoArgs(SVar("pp-NaBL2-Term")),Var("nabl2_term")),NoAnnoList(Str("\" ^ \"")),App(CallNoArgs(SVar("pp-NaBL2-CTerm")),Var("nabl2_params")),NoAnnoList(Str("\" : \"")),App(CallNoArgs(SVar("pp-NaBL2-Type")),Var("nabl2_type")),NoAnnoList(Str("\" ]]\""))]))))),WithClause(Seq(Assign(Var("d_class"),App(CallT(SVar("nabl2--new-var"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"d_class\"")))),Seq(Assign(Var("ty"),App(CallT(SVar("nabl2--new-var"),[],[Var("nabl2_source")]),NoAnnoList(Str("\"ty\"")))),Id))),WithClause(Seq(Assign(Var("nabl2_index"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))),GenDynRules([SetDynRule(DynRuleId(RDecNoArgs("AstMetadata")),RuleNoCond(Var("nabl2_index"),NoAnnoList(List([NoAnnoList(Tuple([NoAnnoList(Op("Params",[])),Var("nabl2_params")])),NoAnnoList(Tuple([NoAnnoList(Op("Type",[])),Var("nabl2_type")]))]))))]))),WithClause(Assign(Var("nabl2_constraint"),NoAnnoList(Op("CConj",[NoAnnoList(Op("CEqual",[Var("nabl2_type"),NoAnnoList(Op("ClassType",[Var("d_class")])),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CGRef",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Class\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),Var("s")])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CResolve",[NoAnnoList(Op("Occurrence",[NoAnnoList(Op("Namespace",[NoAnnoList(Str("\"Class\""))])),Var("x"),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))])),Var("d_class"),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CConj",[NoAnnoList(Op("CPropertyOf",[Var("d_class"),NoAnnoList(Op("Type",[])),Var("ty"),NoAnnoList(Str("\"\"")),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Default",[])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("nabl2_term"))]))])),NoAnnoList(Op("CInequal",[Var("ty"),NoAnnoList(Op("MainType",[])),NoAnnoList(Op("Message",[NoAnnoList(Op("Error",[])),NoAnnoList(Op("Text",[NoAnnoList(Str("\"Cannot refer to main class\""))])),App(CallNoArgs(SVar("nabl2--get-ast-index")),Var("x"))]))]))]))]))]))]))))]))])])